<%- include('templates/header') %>

<button id="ai-button">Press me!</button>

<div id="output" style="margin-top: 20px; font-size: 18px;"></div>

<script>
  document.getElementById('ai-button').addEventListener('click', main);

  async function main() {
    try {
      const res = await fetch('/api/gemini', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ prompt: "What produce is in season? Answer should fit in a modal" })
      });

      const data = await res.json();
      console.log(data);
      document.getElementById('output').innerText = data || "No response";
    } catch (error) {
      console.error('Error:', error);
      document.getElementById('output').innerText = 'Error contacting Gemini API';
    }
  }
</script>

<!-- <head>
    <script
        id="search-js"
        defer
        src="https://api.mapbox.com/search-js/v1.0.0-beta.22/web.js"
    >
    </script>
    <script>
        const script = document.getElementById('search-js');
        script.onload = function() {
            mapboxsearch.autofill({
                accessToken: '<%= mapboxToken %>'
            });
        };
    </script>
    </head>

    <form method="POST" action="/testPost">
        <input name="address" data-property="address" placeholder="Address" type="text" autocomplete="address-line1" />
        <input name="city" style="visibility: hidden;" placeholder="City" type="text" autocomplete="address-level2" />
        <input name="province" style="visibility: hidden;" placeholder="Province" type="text" autocomplete="address-level1" />
        <input name="postalCode" style="visibility: hidden;" placeholder="Postal Code" type="text" autocomplete="postal-code" />

        <button type="submit">Submit</button>
    </form> -->

<%- include('templates/footer') %>